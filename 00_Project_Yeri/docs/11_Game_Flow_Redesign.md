# 11_Game_Flow_Redesign.md

## "예리는 못 말려" 게임 플로우 재설계 (확정)

**작성일**: 2025-11-09
**버전**: v2.0 (최종 확정)
**기획**: 사용자 + Claude 협의

---

## 📋 핵심 변경 사항

### 1. 게임 시간 재조정 ✅

| 모드 | 1턴 | 2턴 | 3턴 | 총 시간 |
|------|-----|-----|-----|---------|
| **짧은 데이트** | 3초 | 10초 | 40초 | 53초 |
| **긴 데이트** | 3초 | 10초 | 60초 | 73초 |

**변경 이유**:
- 1턴 3초: 실패 전제 (재미 요소)
- 2턴 10초: 70% 미묘한 차이 고려
- 3턴 40초/60초: 마지막 기회 + 충분한 관찰 시간

---

## 🎮 전체 게임 플로우 (상세)

### 화면 1: 게임 모드 선택
```
[시작 화면]
  ↓
- 짧은 데이트 ⏱️ (3→10→40초)
- 긴 데이트 💕 (3→10→60초)
  ↓
선택 완료
```

**UI**: 카드 선택 방식 (현재 구현 완료)

---

### 화면 2: 플레이어 정보 입력
```
[정보 입력 화면]
  ↓
- 닉네임 입력 (최대 10자)
- 연령대 선택 (10대/20대/30대)
  ↓
"게임 시작" 버튼
```

**UI**: 폼 입력 방식 (현재 구현 완료)

---

### 화면 3: 인트로 + Before 이미지 (신규 설계)

#### Phase 3-1: 예리 등장 애니메이션
```
[화면 전체 배경: 부드러운 그라데이션]
  ↓
예리 얼굴 이모지 스타일 (동동 떠있는 애니메이션)
  ↓
TTS + 자막:
"오빠 오빠 ㅜ 벌써 왔어? ㅜㅜ"
"예리 아직 준비 못했는데... ㅜㅜ"
"금방 준비하고 올께~~~"
  ↓
(또각또각또각 사운드 효과)
  ↓
TTS + 자막:
"오빠 나 왔오~~~ ㅎㅎ"
```

**Duration**: 약 5~7초
**목적**: 스토리 몰입, Before 이미지 충분한 관찰 시간 제공

#### Phase 3-2: Before 이미지 표시
```
[예리 Before 이미지 전체 화면]
  ↓
예리 얼굴 (작게, 화면 하단) + TTS:
"근데 오빠, 나 뭐 바뀐거 없어?"
"오빠 3초 안에 맞추기다~~~"
  ↓
화면 하단:
[예리가 바뀐 부분을 찾아주세요~] 버튼
```

**중요**: 타이머는 아직 시작 안 함!
**플레이어 행동**: Before 이미지 충분히 관찰 (10~20초 자유 시간)

---

### 화면 4: 1턴 시작 (3초)

#### Phase 4-1: 버튼 클릭 → 즉시 시작
```
플레이어가 [예리가 바뀐 부분을 찾아주세요~] 클릭
  ↓
화면 전환 (0.5초 페이드)
  ↓
After 이미지 전체 화면 표시
+ 타이머 즉시 시작! ⏱️ 3초
```

**중요**: 버튼 클릭 즉시 시작 (카운트다운 없음)

#### Phase 4-2: 게임 진행 (3초)
```
[After 이미지 전체 화면]
  ↓
상단: 진행 바 (3초 카운트다운)
중간: After 이미지
하단: 텍스트 입력창 + 제출 버튼
  ↓
플레이어 입력 (연속 제출 가능)
  ↓
3초 종료 or 시간 내 제출
```

#### Phase 4-3: 1턴 결과
```
팝업 (상단 토스트):
"오빠~ 실망이야. 나에 대한 관심이 이거밖에 안되? ㅜㅜ"
"너무 실망인데? 예리 삐진다.."
  ↓
예리 얼굴 이모지 (화면 중앙):
"한 번 더 기회를 줄까?"
  ↓
버튼:
[기회 한 번 더 받아 예리 기분 풀어주기]
```

**Note**: 1턴은 성공/실패 무관하게 항상 이 멘트

---

### 화면 5: 2턴 시작 (10초)

#### Phase 5-1: 버튼 클릭 → 즉시 시작
```
[기회 한 번 더 받아...] 클릭
  ↓
화면 전환 (0.5초 페이드)
  ↓
Before/After 좌우 분할 화면
+ 타이머 즉시 시작! ⏱️ 10초
+ 🎤 음성 녹음 자동 활성화 (신규!)
```

#### Phase 5-2: 게임 진행 (10초)
```
[Before/After 분할 화면]
  ↓
좌측: Before 이미지 (BEFORE 라벨)
우측: After 이미지 (AFTER 라벨)
상단: 진행 바 (10초 카운트다운)
하단: 텍스트 입력 + 🎤 음성 입력 동시 가능
  ↓
플레이어 행동:
- 텍스트 입력 → 엔터로 연속 제출 가능
- 음성 입력 → 실시간 STT → 자동 제출
  ↓
중간 피드백 (EEVE 실시간 분석):
- 정답 가까움: "오~ 오빠 눈썰미 좋은데?"
- 오답: "음.. 그건 아닌 것 같은데!"
```

**신규 기능**:
- 🎤 **자동 음성 녹음 시작**
- **연속 입력 가능** (여러 번 시도 가능)
- **실시간 EEVE 피드백** (정답 가까움 감지)

#### Phase 5-3: 2턴 결과
```
팝업 (상단 토스트, 랜덤):
- 정답: "역시 우리 오빠 최고~! 💕"
- 오답: "앗.. 아쉬운데? 😢"
  ↓
2초 대기
  ↓
자동으로 3턴 전환
```

---

### 화면 6: 3턴 시작 (40초/60초)

#### Phase 6-1: 자동 전환 (카운트다운 없음)
```
2턴 종료 후 2초 대기
  ↓
화면 전환 (0.5초 페이드)
  ↓
Before/After 분할 화면 유지
+ 타이머 즉시 시작! ⏱️ 40초/60초
+ 🎤 음성 녹음 계속 활성화
```

#### Phase 6-2: 게임 진행 (40초/60초)
```
[Before/After 분할 화면]
  ↓
2턴과 동일한 UI
  ↓
예리 대사 (화면 하단):
"마지막 기회야! 정확히 뭐가 바뀌었는지 말해줘!"
  ↓
플레이어 행동:
- 텍스트/음성 연속 입력
- 충분한 시간으로 자세히 관찰
  ↓
중간 피드백 (계속)
```

#### Phase 6-3: 3턴 결과 + 게임 종료
```
팝업 (상단 토스트, 랜덤):
- 정답: "완전 찰떡이야! 🥰"
- 오답: "아쉽다~ 다음엔 잘할 수 있어! 😊"
  ↓
2초 대기
  ↓
최종 점수 계산
  ↓
결과 화면으로 전환
```

---

### 화면 7: 결과 화면
```
[엔딩 메시지]
  ↓
- love (80~100점): "완벽해! 우리 완전 찰떡궁합이야! 💕"
- cute_upset (50~79점): "음... 관심은 있는 것 같은데! 😤"
- breakup (0~49점): "오빠... 우리 그만 만나자 💔"
  ↓
[점수 분석]
- 💕 감정센스: XX점
- 👀 관찰력: XX점
- ⚡ 순발력: XX점
- 🔥 콤보 보너스: +X점
- 최종 점수: XX/100점
  ↓
[공유 버튼]
- 📸 인스타그램 스토리
- 💬 카카오톡 공유
- 🐦 트위터
- 📘 페이스북
- 🔗 결과 텍스트 복사
  ↓
[다시하기] 버튼
```

---

## 🎤 실시간 음성 입력 설계 (신규)

### 기술 스펙:

#### 1. 음성 녹음 시작 타이밍
```
2턴 시작 → 자동 🎤 활성화
3턴 시작 → 계속 활성화 유지
```

#### 2. STT (Speech-to-Text) 처리
```
사용자 음성 입력
  ↓
Web Speech API (브라우저 내장)
  ↓
실시간 텍스트 변환
  ↓
EEVE LLM 전송
  ↓
감정 분석 + 정답 판정
  ↓
예리 반응 (TTS + 텍스트 팝업)
```

#### 3. 실시간 피드백 플로우
```
플레이어: "헤어스타일 바뀌었어!"
  ↓
STT: "헤어스타일 바뀌었어"
  ↓
EEVE 분석: 정답 가까움 (관찰력 70%)
  ↓
예리 반응 (TTS):
"오~ 오빠 눈썰미 좋은데?"
+ 팝업 (토스트): "오~ 오빠 눈썰미 좋은데?"
  ↓
플레이어 계속 입력 가능
```

#### 4. 연속 입력 처리
- **텍스트**: 엔터 누를 때마다 제출
- **음성**: 실시간 변환 → 자동 제출
- **제한**: 없음 (시간 내 무제한 시도)

---

## 🎨 필요 Asset 리스트 (디자이너 작업)

### 1. 예리 캐릭터 이모지 (최우선!)

#### 파일명: `yeri_emoji_[expression].png`
#### 사이즈: 400x400px (Retina: 800x800px)
#### 포맷: PNG (투명 배경)

| 파일명 | 감정 | 사용 위치 | 표정 설명 |
|--------|------|-----------|-----------|
| `yeri_emoji_intro.png` | 기본 | 인트로 | 밝고 친근한 미소 |
| `yeri_emoji_waiting.png` | 준비중 | 인트로 | 약간 당황한 표정 |
| `yeri_emoji_ready.png` | 준비완료 | 인트로 | 자신만만한 표정 |
| `yeri_emoji_disappointed.png` | 실망 | 1턴 결과 | 삐진 표정 (볼록 뺨) |
| `yeri_emoji_sulking.png` | 삐침 | 1턴 결과 | 입 삐죽 |
| `yeri_emoji_hint.png` | 힌트 | 2-3턴 중간 | 윙크 + 손가락 |
| `yeri_emoji_close.png` | 정답 가까움 | 2-3턴 중간 | 기대하는 표정 |
| `yeri_emoji_wrong.png` | 오답 | 2-3턴 중간 | 고개 가로젓는 표정 |
| `yeri_emoji_correct.png` | 정답 | 2-3턴 중간 | 환호하는 표정 |
| `yeri_emoji_love.png` | 사랑 엔딩 | 결과 화면 | 하트 눈 + 볼 하트 |
| `yeri_emoji_cute_upset.png` | 귀엽게 삐진 | 결과 화면 | 살짝 삐진 귀여운 표정 |
| `yeri_emoji_breakup.png` | 이별 엔딩 | 결과 화면 | 눈물 |

**스타일 가이드**:
- 애니메이션 캐릭터 스타일 (일본 애니 또는 웹툰)
- 얼굴만 (목 위)
- 동동 떠있는 느낌 (그림자 추가)
- 표정이 과장되게 (감정 전달력 UP)

---

### 2. Before/After 이미지 (게임 콘텐츠)

#### 파일명: `yeri_[difficulty]_[variation]_before/after.png`
#### 사이즈: 1080x1920px (세로 비율, 모바일 최적화)
#### 포맷: PNG 또는 JPG

| 난이도 | 파일명 예시 | 차이점 |
|--------|-------------|--------|
| **A (70%)** - 매우 미묘 | `yeri_hard_001_before.png` | 가르마 2cm 이동 |
| **A (70%)** | `yeri_hard_002_before.png` | 렌즈 브라운→딥브라운 |
| **A (70%)** | `yeri_hard_003_before.png` | 아이라인 0.2cm 상승 |
| **B (20%)** - 중간 | `yeri_medium_001_before.png` | 헤어스타일 변화 |
| **B (20%)** | `yeri_medium_002_before.png` | 블러셔 위치 변경 |
| **C (10%)** - 명확 | `yeri_easy_001_before.png` | 옷 색상 완전 변경 |

**초기 필요량**: 난이도별 3세트 (총 18개 이미지)
**확장 가능**: 추후 추가

---

### 3. 팝업/UI Asset (추후)

#### 파일명: `popup_[type].png`
#### 사이즈: 600x200px
#### 포맷: PNG (투명 배경)

| 파일명 | 타입 | 설명 |
|--------|------|------|
| `popup_correct.png` | 정답 | 반짝이는 배경 + 예리 기쁜 표정 |
| `popup_wrong.png` | 오답 | 어두운 배경 + 예리 실망 표정 |
| `popup_combo.png` | 콤보 | 불꽃 효과 + "COMBO!" |
| `popup_hint.png` | 힌트 | 전구 + 예리 윙크 |

**우선순위**: 낮음 (현재 CSS로 충분)

---

### 4. 사운드 Asset

#### 파일명: `[type]_[variation].mp3`
#### 포맷: MP3 (압축), WAV (원본)

| 파일명 | 설명 | 사용 위치 |
|--------|------|-----------|
| `footsteps_01.mp3` | 또각또각또각 | 인트로 |
| `correct_01.mp3` | 딩동댕~ (정답) | 정답 시 |
| `wrong_01.mp3` | 땡! (오답) | 오답 시 |
| `combo_01.mp3` | 불꽃 효과음 | 콤보 시 |
| `bgm_game.mp3` | 배경음악 (경쾌한 리듬) | 게임 중 |

**우선순위**: 중간

---

### 5. TTS 대사 녹음 (예리 목소리)

#### 파일명: `tts_[scene]_[line].mp3`

| 파일명 | 대사 | 사용 위치 |
|--------|------|-----------|
| `tts_intro_01.mp3` | "오빠 오빠 ㅜ 벌써 왔어? ㅜㅜ" | 인트로 |
| `tts_intro_02.mp3` | "예리 아직 준비 못했는데... ㅜㅜ" | 인트로 |
| `tts_intro_03.mp3` | "금방 준비하고 올께~~~" | 인트로 |
| `tts_intro_04.mp3` | "오빠 나 왔오~~~ ㅎㅎ" | 인트로 |
| `tts_intro_05.mp3` | "근데 오빠, 나 뭐 바뀐거 없어?" | Before 화면 |
| `tts_intro_06.mp3` | "오빠 3초 안에 맞추기다~~~" | Before 화면 |
| `tts_turn1_fail.mp3` | "오빠~ 실망이야. 나에 대한 관심이 이거밖에 안되? ㅜㅜ" | 1턴 결과 |
| `tts_turn1_retry.mp3` | "한 번 더 기회를 줄까?" | 1턴 결과 |
| `tts_turn3_final.mp3` | "마지막 기회야! 정확히 뭐가 바뀌었는지 말해줘!" | 3턴 시작 |

**총 대사 수**: 약 30~40개 (정답/오답 랜덤 포함)
**목소리**: 밝고 귀여운 20대 여성 (성우 녹음 or AI TTS)

---

## 🔧 기술 구현 우선순위

### Phase 1 (현재 완료):
- ✅ 기본 UI 구조
- ✅ 게임 플로우 (간소화 버전)
- ✅ 타이머 시스템
- ✅ 점수 계산

### Phase 2 (다음 작업):
1. 🎤 **음성 입력 기능 추가** (Web Speech API)
2. 🖼️ **인트로 화면 구현** (예리 등장 + Before 이미지)
3. 🔘 **"시작" 버튼 추가** (플레이어 주도 시작)
4. 🔄 **연속 입력 기능** (엔터로 여러 번 제출)

### Phase 3 (EEVE 연동):
1. 📡 **EEVE API 통합** (감정 분석)
2. 💬 **실시간 피드백** (정답 가까움 감지)
3. 🎯 **정답 판정 로직** (LLM 기반)

### Phase 4 (폴리싱):
1. 🎨 **Asset 교체** (CSS → 이미지)
2. 🔊 **TTS/STT 통합**
3. 🎵 **사운드 효과 추가**
4. 📱 **모바일 최적화**

---

## 📋 변경 사항 확인 체크리스트

### ✅ 확정된 사항:

- [x] 게임 시간: 짧은 데이트 (3→10→40초), 긴 데이트 (3→10→60초)
- [x] 난이도: A/B 중심 (실패 포함 도전적)
- [x] 타겟: 10~20대
- [x] 차이점 비중: 70% 매우 미묘 / 20% 중간 / 10% 명확
- [x] 1턴 컨셉: 실패 전제 (재미 요소)
- [x] 음성 입력: 2~3턴 자동 활성화
- [x] 연속 입력: 시간 내 무제한 시도 가능
- [x] 시작 방식: "시작" 버튼 클릭 (플레이어 주도)
- [x] 이미지 높이 문제 해결 (min-h-[500px])
- [x] 팝업 위치 조정 (top-32)

### 📝 사용자 확인 필요:

1. **게임 플로우**가 의도와 일치하나요?
2. **Asset 리스트**가 충분한가요? 추가 필요한 것이 있나요?
3. **TTS 대사**가 적절한가요?
4. **실시간 음성 입력** 구현 우선순위는 어떻게 할까요?

---

**문서 종료**
