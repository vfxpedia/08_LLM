# 04. 시스템 아키텍처

## 4.1 전체 시스템 구조도

```
[사용자]
   ↓
[Frontend: React + TypeScript]
   ↓ (HTTP/REST API)
[Backend: FastAPI/Flask]
   ↓
┌───────────┴──────────┐
↓                      ↓
[RDB: PostgreSQL]    [Vector DB: pgvector]
- 공고 메타데이터      - 공고 PDF 임베딩
- 사용자 정보          - Glossary 임베딩
- 즐겨찾기/비교        - RAG 검색
   ↓
[LLM: OpenAI GPT-4o-mini]
   ↓
[외부 API]
- data.go.kr (공고 데이터)
- 주택도시기금 (대출 정보)
```

---

## 4.2 기술 스택

### 4.2.1 Frontend

- **Framework**: React 18 + TypeScript + Vite
- **UI Library**: shadcn/ui + Radix UI
- **Routing**: React Router v6
- **Styling**: TailwindCSS
- **State Management**: React Context API
- **Form**: React Hook Form

### 4.2.2 Backend

**[논의 필요]**

옵션 1: **FastAPI** (추천)
- 장점: 빠름, 타입 안전, 자동 문서화, 비동기 지원
- 단점: Python 3.7+ 필요

옵션 2: **Flask**
- 장점: 간단, 익숙함
- 단점: 비동기 지원 부족

**추천**: FastAPI

### 4.2.3 Database

**RDB**: PostgreSQL 14+
- 공고 메타데이터
- 사용자 정보
- 즐겨찾기/비교 목록

**Vector DB**: pgvector (PostgreSQL 확장)
- 공고 PDF 임베딩
- Glossary 임베딩
- 벡터 유사도 검색

### 4.2.4 AI/LLM

- **LLM**: OpenAI GPT-4o-mini
- **Embedding**: Sentence-Transformers (or OpenAI embeddings)
- **Vector Search**: pgvector cosine similarity

### 4.2.5 배포

- **Containerization**: Docker + Docker Compose
- **Database Tool**: DBeaver
- **Version Control**: Git + GitHub

---

## 4.3 데이터 파이프라인

### 4.3.1 데이터 수집

```
[공공 API / 크롤링]
   ↓
[CSV 저장]
- lh_lease_notices_eng.csv
- lh_sale_notices_eng.csv
- sh_notice.csv
   ↓
[PDF 다운로드]
- LH_lease.zip (12.7GB)
- LH_sale.zip (2.4GB)
   ↓
[Markdown 변환]
   ↓
[임베딩 생성]
   ↓
[Vector DB 저장]
```

### 4.3.2 RAG 파이프라인

```
[사용자 질문]
   ↓
[질문 임베딩]
   ↓
[Vector DB 검색]
- Top-K 유사 문서 추출
   ↓
[LLM 프롬프트 구성]
- System Prompt + Retrieved Docs + User Query
   ↓
[LLM 답변 생성]
   ↓
[답변 후처리]
- 출처 표시
- 형식 정리
   ↓
[사용자에게 응답]
```

---

## 4.4 API 설계 (개요)

상세 내용은 "06_백엔드_API_설계.md" 참조

주요 엔드포인트:
- POST /api/chat: LLM 대화
- GET /api/announcements: 공고 목록
- GET /api/announcements/{id}: 공고 상세
- POST /api/user/profile: 사용자 프로필 저장
- GET /api/user/favorites: 즐겨찾기 조회

---

## 4.5 보안 및 성능

### 4.5.1 보안

**[논의 필요]**

- 사용자 인증: JWT (향후)
- 개인정보 보호: 암호화 저장
- API 키 관리: 환경변수
- CORS 설정

### 4.5.2 성능

**[논의 필요]**

- 캐싱: Redis (향후)
- CDN: Cloudflare (향후)
- 로드 밸런싱: (향후)
- DB 인덱싱: 주요 검색 필드

---

**작성일**: 2025년 11월 21일

**작성자**: 오흥재

**상태**: 초안 (사용자 논의 필요)
