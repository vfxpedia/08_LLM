# 02\_Score\_System\_Detail.md

## 1. 개요

이 문서는 ‘예리는 못 말려’ 프로젝트의 **점수 시스템(100점 만점) 세부 설계** 문서다. 플레이어의 반응(관찰력·감정 센스·순발력)을 기반으로 점수를 계산하며, EEVE LLM의 감정 해석 결과 및 VectorDB 유사도 분석을 반영해 정량화한다. 게임의 본질은 단순한 차이찾기가 아니라 **감정 기반 연애 커뮤니케이션 실험**에 있다.

---

## 2. 점수 시스템 설계 개요

### 2.1 목적

- 플레이어의 감정 표현, 공감력, 관찰 능력을 정량화.
- LLM과 VectorDB를 결합하여 유저의 언어적 센스를 정성→정량으로 변환.
- 점수는 예리의 반응(TTS)·엔딩·SNS 공유 카드로 직결됨.

### 2.2 총점 구성 (100점)

| 항목     | UI 표기명       | 설명                     | 배점(%)       |
| ------ | ------------ | ---------------------- | ----------- |
| 감정 센스  | 💞 우리 오빠 공감력 | 대답의 감정 표현력·공감도·어조 평가   | 60점         |
| 관찰력    | 👀 오빠의 눈썰미   | 이미지에서 변화 포인트를 얼마나 맞췄는가 | 25점         |
| 순발력    | ⚡ 오빠의 반응 스피드 | 정답까지 걸린 시간 보너스         | 15점         |
| **총합** | **사랑 점수 총계** | 감정 + 관찰 + 속도의 종합 평가    | **100점 만점** |

---

## 3. 평가 항목별 세부 로직

### 3.1 관찰력 (Observation, 0\~25점)

- 이미지의 변화 포인트(`N_total`, 기본 5개)를 얼마나 맞췄는지 계산.
- 턴(1\~3차 시도) 중 가장 많이 맞춘 결과를 사용.

```
match_ratio = N_correct / N_total
obs_score = round(match_ratio * 25)
```

| 맞춘 비율   | 점수      | 해석             |
| ------- | ------- | -------------- |
| 100%    | 25점     | 완벽한 눈썰미, 예리 감동 |
| 70\~99% | 18\~22점 | 디테일에 강한 오빠     |
| 40\~69% | 10\~17점 | 감은 있지만 아쉬움     |
| 0\~39%  | 0\~9점   | 예리의 한숨 유발      |

---

### 3.2 감정 센스 (Emotion Sense, 0\~60점)

#### A. 점수 산출 로직

EEVE LLM + VectorDB 하이브리드 방식 적용.

```
# Vector 유사도 기반 감정 분류
similarity, label = VectorDB.compare(user_text)

if label == 'S': base = 0.9
elif label == 'A': base = 0.7
elif label == 'B': base = 0.5
else: base = 0.1

emotion_raw = clamp(base - α * (1 - similarity), 0.0, 1.0)
emotion_score = round(emotion_raw * 60)
```

#### B. 평가 요소 및 예시

| 평가 요소    | 예시                         | 점수대     |
| -------- | -------------------------- | ------- |
| 최고 센스(S) | “앞머리 내렸지? 오늘 귀여운 매력 폭발이야.” | 50\~60점 |
| 좋은 센스(A) | “립색 바꿨지? 오늘 분위기 달라졌어.”     | 40\~49점 |
| 보통(B)    | “머리 바꿨네.”                  | 20\~39점 |
| 비호감(D)   | “살 좀 찐 거 같은데?”             | 0\~10점  |

#### C. UI 표기

- 💬 **우리 오빠의 공감 점수** (Empathy Level)
- 🎨 **센스 지수** (Style Compliment Score)

두 지표를 합쳐 감정 센스 총점으로 표시.

---

### 3.3 순발력 (Speed, 0\~15점)

턴은 총 3회 진행:

1. 1턴(3초): 의도적 긴장감 유발, 보너스 없음.
2. 2턴(10초): 실질적 정답 가능 시간.
3. 3턴(30초): 마지막 기회.

가장 빨리 “정답 또는 고감정 센스 대답”을 한 시점으로 점수 산출.

```
if reaction_time >= 30:
    speed_raw = 0
else:
    speed_raw = 1 - (reaction_time / 30)

speed_score = round(speed_raw * 15)
```

| 반응 시간   | 점수      | 설명       |
| ------- | ------- | -------- |
| 0\~3초   | 13\~15점 | 순간 센스폭발  |
| 4\~10초  | 8\~12점  | 빠른 반응    |
| 11\~20초 | 4\~7점   | 고민형 감정형  |
| 21\~30초 | 1\~3점   | 느리지만 진심형 |
| 초과      | 0점      | 예리 실망    |

---

## 4. 최종 점수 계산

```
final_score = obs_score + emotion_score + speed_score
```

UI 예시 표기:

```
눈썰미 점수 (👀)      : 20 / 25
공감 + 센스 점수 (💞) : 48 / 60
순발력 점수 (⚡)       : 10 / 15
--------------------------------
우리 오빠 사랑 총점 💗 : 78 / 100
```

- 감정 중심 설계를 반영해 감정 센스가 전체 점수의 60%를 차지.
- 3턴 중 최고 성과를 기준으로 계산하여 불필요한 복잡도 최소화.

---

## 5. EEVE LLM 및 VectorDB 연동 설계

### 5.1 데이터 입력 구조

```
Input = {
  "user_text": str,           # 유저 답변(STT 변환 가능)
  "detected_changes": list,   # 이미지 비교 결과
  "reaction_time": float,     # 응답 시간
  "emotion_context": str,     # 예리 감정 상태
  "turn_index": int           # 1~3턴 구분
}
```

### 5.2 프로세스 흐름

1. 각 턴의 유저 답변 수집 (텍스트/음성)
2. EEVE가 감정 분석 → VectorDB 유사도 검색
3. 감정/관찰/속도 스코어 계산 후 최고 점수 선택
4. 예리 TTS 피드백 생성 (중간·엔딩 반응)

---

## 6. 향후 개선 및 확장 아이디어

- 감정 센스 세분화 (공감 점수 + 스타일 칭찬 점수 별도 표기)
- 음성 감정 분석 추가 (TTS 감정 연동)
- VectorDB 학습 데이터 확대 (센스 좋은 문장 500+ 샘플 구축)
- 턴별 피드백 자동 조정 (예리의 반응 스크립트 다양화)

---

## 7. 연계 문서

- **01\_Game\_Structure.md:** 3턴 진행 구조·시간 배분 연계.
- **03\_Character\_Design.md:** 예리 표정·대사·음성 변화 설계.
- **04\_LLM\_Prompt\_Design.md:** 감정·공감·센스 평가용 프롬프트 구조.
- **05\_Gameplay\_Mechanics.md:** 점수 계산 및 상태 관리 로직 통합.

